# EZ-CHESS
专为战棋而生的框架

### 使用须知
本框架是个脚手架,将战棋流程抽象出来,为开发提供便利.

### 框架特色
1. 状态和节点分离:我将棋子的状态和游戏节点分离为PieceState和PieceInstance,然后通过某种方式让PieceState驱动PieceInstance改变.目的是实现前后端分离,也是实现异步更新前端的基础.</br>
2. 管线化:玩家的操作会封装为对象并入队,由状态管线监听并异步执行,渲染管线也是如此,这样就实现异步更新.</br>
3. 事件驱动:管线之间不是直接耦合的,而是通过事件总线联系在一起.当状态管线接受到玩家的操作事件后,会将事件subscribe到事件总线.然后玩家操作执行完成后,会调用publish执行注册的事件,该事件就是去执行渲染管线相关的操作.</br>
4. 组件化:战棋游戏往往存在很多装备和buff,为了应对这些复杂多变的状态,如果用继承可能会导致组合爆炸,所以我使用装饰器链将PieceState和PieceInstance层层封装,更加灵活的配置他们.</br>

### 使用方法
1. 框架主要代码都在script/framwork中.
2. ```valve```是对玩家操作的抽象,诸如移动,攻击都是由valve来调用.
3. ```state```和```instance```是对状态和节点的抽象,存储了必要的参数.一般是不需要继承的,除非有特别需求.
4. ```decorator```是装饰器,分为PieceStateDecorator和PieceInstanceDecorator,分别封装状态和节点.使用方法是继承这两个类,然后添加响应的接口和状态即可.
5. ```PieceAdapter```封装了```state```和```instance```,继承他并实现诸如移动等操作,一般调用的是```state```的函数.
6. ```PieceFactory```,创建棋子的工厂,需要继承```PieceFactoryBase```,然后将其挂载在```game.tscn```的```GameLoader```节点.
